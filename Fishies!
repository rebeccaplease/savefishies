
int frameSize = 500;
float sky = 75;

int score =  0;

//initial squid position
float squidPosX = frameSize/2;
float squidPosY = frameSize/2;

float squidSize = 50;

float squidVelX = 6;
float squidVelY = 6;

//initial velocity
float v = 6;

//detect if key still pressed
boolean keyup = false;
boolean keyright = false;
boolean keyleft = false;
boolean keydown = false;

//records how long the key is pressed
int timeUp = 0;
int timeDown = 0;
int timeLeft = 0;
int timeRight = 0;

Fish[] fish = new Fish[10];
Hook[] hook = new Hook[3];
int level = 1; //total number of fish will be from 1 to level

//images
PImage squid;
PImage nemoLeft;
PImage nemoRight;
void setup()
{
  size(frameSize, frameSize);
  textSize(20);
  ellipseMode(RADIUS);
  for(int k = 0; k < 10; k++)  //fill fish array
  { 
    fish[k] = new Fish();
  }
  for(int a = 0; a < 3; a++) //fill hook array
  {
    hook[a] = new Hook();
  }
  squid = loadImage("squid.jpg");
  nemoLeft = loadImage("greenNemoLeft.jpg");
  nemoRight = loadImage("greenNemoRight.jpg");
}

void draw()
{
  //background color
  background(#33F2F9);
  noStroke();
  fill(#FFFFFF);
  rect(0, 0, frameSize, sky); 
  
  //scoreboard, change font
  fill(#000000);
  text("Score: " + score, 10, frameSize - 10 );
  
  //squid!
  fill(#5D209A);
  //ellipse(squidPosX, squidPosY, squidSize, squidSize);
  image(squid, squidPosX, squidPosY, squidSize, squidSize);
  
 //lines/hooks!
  stroke(1);

//fish!
fill(#00FF00);

for(int a = 0; a < level; a++) //draw level number of fish
{ 
  
  //draw fish
  fish[a].move();
  if(fish[a].endOfLine()) //if reaches edge of screen
  {
    fish[a].change(); //change location
    if(level < 10)
      level++;
  }
}
for(int b = 0; b < 3; b++)
{
  hook[b].move();
}
  
  //if(fishscore)
  //score++; 

}

//move squid. the longer each key is held down, the faster it moves

void keyPressed() {
  if (key == CODED)
  {
    if (keyCode == UP || keyup) 
    {
      squidVelY = v + timeUp * 0.1;
        if(squidPosY - squidVelY < sky + squidSize) //if it will move past the top border
          squidPosY = sky + squidSize; //set position to touching the top border
        else 
          squidPosY -= squidVelY;
      keyup = true;
      timeUp++;
    } 
     if (keyCode == DOWN || keydown) 
    {
      squidVelY = v + timeDown * 0.1;  
        if(squidPosY + squidVelY > frameSize - squidSize) //if it will move past the bottom border
          squidPosY = frameSize - squidSize; //set position to touching the bottom border
        else
          squidPosY += squidVelY;
      keydown = true;
      timeDown++;
    }
     if(keyCode == LEFT || keyleft)
    {
      if(squidPosX > squidSize/2)
      {
      squidVelX = v + timeLeft * 0.1; 
        if(squidPosX - squidVelX < squidSize) //if it will move past the border
          squidPosX = squidSize; //set position to touching the left border
        else
          squidPosX -= squidVelX;
      keyleft = true;
      timeLeft++;
      }
    }
     if(keyCode == RIGHT || keyright)
    {
      squidVelX = v + timeRight * 0.1; 
        if(squidPosX + squidVelX > frameSize - squidSize) //if it will move past the border
          squidPosX = frameSize - squidSize; //set position to touching right border
        else
          squidPosX += squidVelX;
      keyright = true;
      timeRight++;
    }
  }
}
 
void keyReleased() {
  if (key == CODED) 
  {
    if (keyCode == UP) {
      keyup = false; 
      timeUp = 0;
    }
    if (keyCode == DOWN) {
      keydown = false; 
      timeDown = 0;
    }
    if (keyCode == LEFT) {
      keyleft = false; 
      timeLeft = 0;
    }
    if (keyCode == RIGHT) {
      keyright = false; 
      timeRight = 0;
    }
  }
}

class Fish{
  float fWidth = random(20, 40) ;
  float fLength = fWidth * 0.5;  
  float fX = int(random(2)) * frameSize; //random int, 0 or 1. starting at left or right
  float fY = random(sky + 100, frameSize-100); //stays constant while it moves across the screen
  float fV = random(0.5, 1.0); 
    
  Fish(){
    if(fX > 0)
    fV *= -1;
  }
  
  void change(){
    fX = int(random(2)) * frameSize;
    fY = random(sky + 100, frameSize-100);
    fV = random(0.4,0.6); 
    if(fX > 0)
      fV *= -1;
  }
  
  boolean endOfLine(){
    if(fX < 0 || fX > frameSize)
      return true;
    return false;
  }
  
  void move() {
    //ellipse(fX, fY, fWidth, fLength);
    if(fV > 0)
      image(nemoRight, fX, fY, fWidth, fLength);
    else
      image(nemoLeft, fX, fY, fWidth, fLength);
    fX += fV;
  }
}

class Hook {
float hookX = random(50, frameSize-50);
float hookY = sky;
float endY = random(sky + 50, frameSize-50);

float vX = .5;
float vY = random(.5, 1.5); //random velocity
 
   void move(){
   if (hookY < endY) { //if the length is less than the endpoint
    hookY += vY;    //keep moving
    line(hookX, sky, hookX, hookY); //x stays same, y from sky to next pos
    noFill();
    arc(hookX, hookY-20, 20, 20, 0, HALF_PI, OPEN);
  } 
  else { //after it reaches the endpoint
    endY = sky; //change endY to sky
    hookY -= vY;
    line(hookX, sky, hookX, hookY); 
    noFill();
    arc(hookX, hookY-20, 20, 20, 0, HALF_PI, OPEN);

    if( hookY <= endY) //if reaches sky again
    { //reset to new x pos. draw down again
      endY = random(sky + 50, frameSize-50);
      hookX =  random(50, frameSize-50);
    }
   }
  }
  
}


